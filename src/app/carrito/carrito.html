<app-navbar></app-navbar>

<h1 class="estiloLetra text-center text-2xl sm:text-3xl lg:text-4xl m-3 sm:m-5">Carrito</h1>

<!-- Mensaje si el carrito está vacío -->
@if (productosEnCarrito.length === 0) {
  <div class="flex items-center p-4 mb-4 text-sm text-blue-800 border border-blue-300 rounded-lg bg-blue-50 mx-2 sm:mx-5" role="alert">
    <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
      <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
    </svg>
    <span class="sr-only">Info</span>
    <div>
      <span class="font-medium">Tu carrito está vacío</span> No hay productos añadidos al carrito. ¡Explora nuestra tienda para encontrar productos increíbles!
    </div>
  </div>
}

<div class="grid grid-cols-1 lg:grid-cols-5 gap-2 m-2 sm:m-5">

  <!-- Productos -->
  <div class="bg-gray-50 border border-red-600 border-4 rounded-xl p-2 sm:p-4 lg:col-span-3 lg:row-span-5 order-1 lg:order-none text-red-600 ">
    <h2 class="estiloLetra text-center text-lg sm:text-xl lg:text-2xl mb-2 sm:mb-4">Productos</h2>

    <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-3 sm:gap-6 overflow-y-auto max-h-[300px] sm:max-h-[400px] lg:max-h-[500px] p-1 sm:p-2">
      @for (producto of productosEnCarrito; track producto.id) {
        <div class="bg-red-50 block p-3 sm:p-6 border border-default rounded-xl border-red-600 rounded-base shadow-xs text-red-600 ">
          <img class="rounded-base w-full object-cover h-32 sm:h-40 lg:h-48" src="{{producto.foto}}" alt="" />

          <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mt-2 sm:mt-4">
            <h5 class="text-lg sm:text-xl lg:text-2xl font-semibold tracking-tight text-heading mb-2 sm:mb-0">
              {{producto.nombre}}
            </h5>
            <button type="button" (click)="anyadirProducto(producto.id!)" class="inline-flex items-center text-red-600 bg-brand hover:bg-brand-strong border border-transparent focus:ring-4 focus:ring-brand-medium shadow-xs font-medium rounded-base text-xs sm:text-sm px-2 sm:px-4 py-1.5 sm:py-2.5 focus:outline-none self-start sm:self-auto">
              <svg class="w-3 h-3 sm:w-4 sm:h-4 me-1 sm:me-1.5 -ms-0.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 4h1.5L9 16m0 0h8m-8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm-8.5-3h9.25L19 7H7.312"/>
              </svg>
              +
            </button>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-4 mb-3 sm:mb-6 text-xs sm:text-sm text-body">
            <span>Precio: {{producto.precio}} €</span>
            <span>Cantidad: {{obtenerCantidadProducto(producto.id!)}}</span>
          </div>

          <p class="mb-3 sm:mb-6 text-xs sm:text-sm text-body line-clamp-2 sm:line-clamp-none">{{producto.descripcion}}</p>

          <div class="flex flex-col sm:flex-row gap-2 sm:justify-between sm:items-center">
            <a href="#" class="inline-flex items-center text-body bg-neutral-secondary-medium border border-red-600 hover:bg-neutral-tertiary-medium hover:text-heading focus:ring-4 focus:ring-neutral-tertiary shadow-xs font-medium rounded-base text-xs sm:text-sm px-2 sm:px-4 py-1.5 sm:py-2.5 focus:outline-none">
              Ir al producto
              <svg class="w-3 h-3 sm:w-4 sm:h-4 ms-1 sm:ms-1.5 rtl:rotate-180 -me-0.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 12H5m14 0-4 4m4-4-4-4"/></svg>
            </a>
            <button (click)="confirmarQuitarItem(producto.id!)" class="inline-flex items-center text-body bg-neutral-secondary-medium border border-red-600 hover:bg-neutral-tertiary-medium hover:text-heading focus:ring-4 focus:ring-neutral-tertiary shadow-xs font-medium rounded-base text-xs sm:text-sm px-2 sm:px-4 py-1.5 sm:py-2.5 focus:outline-none">
            Quitar producto
          </button>
          </div>
        </div>
      }
    </div>
  </div>

  <!-- Resumen del pedido -->
  <div class="bg-gray-50 border border-blue-400 border-4 rounded-xl p-3 sm:p-4 text-white mt-4 lg:mt-0 lg:col-start-4 lg:col-span-2 lg:row-start-1 lg:row-span-3 order-2 lg:order-none">
    <h2 class="text-lg sm:text-xl lg:text-2xl text-center estiloLetra mb-3 sm:mb-4 text-blue-400">Resumen del pedido</h2>
    <div class="flex flex-col gap-2 sm:gap-4 max-h-48 sm:max-h-56 lg:max-h-64 overflow-y-auto">
      @for (producto of productosEnCarrito; track producto.id) {
        <div class="flex justify-between items-center border border-blue-400 text-blue-400 p-2 sm:p-3 bg-blue-50 rounded-xl">
          <span class="font-semibold text-xs sm:text-sm">{{producto.nombre}} x{{obtenerCantidadProducto(producto.id!)}}</span>
          <span class="font-semibold text-xs sm:text-sm">{{(obtenerPrecioTotalPorCantidadProducto(producto.id!))}}€</span>
        </div>
      }
    </div>
  </div>

  <!-- Total -->
  <div class="bg-gray-50 rounded-xl p-3 border border-4 border-yellow-400 sm:p-4 text-black  mt-4 lg:mt-0 lg:col-start-4 lg:col-span-2 lg:row-start-4 lg:row-span-2 order-3 lg:order-none">
    <p class="text-lg sm:text-xl lg:text-2xl text-center text-yellow-400 estiloLetra">Total</p>
    <div class="flex gap-2 sm:gap-4 mt-2 sm:mt-4">
      <div class="flex justify-center items-center mt-2 sm:mt-4 bg-yellow-50 p-4 sm:p-8 rounded-xl border border-yellow-400 w-full">
        <p class="text-xl sm:text-xl lg:text-xl text-center text-yellow-400 font-bold">{{calcularTotal()}} €</p>
      </div>

      <button class="flex justify-center items-center mt-2 sm:mt-4 bg-yellow-50 p-4 sm:p-8 rounded-xl border border-yellow-400 w-full" (click)="confirmarCompra()">
        <p class="text-xl sm:text-xl lg:text-xl text-center text-yellow-400 font-bold">Pagar</p>
      </button>
    </div>

  </div>

</div>

<app-footer></app-footer>
